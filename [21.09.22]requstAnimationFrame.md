ìœ íŠœë¸Œ ë™ì˜ìƒì„ ë³´ë‹¤ê°€ requestAnimationFrameì´ë€ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤.

ê¸°ì¡´ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•´ì„œ ì• ë‹ˆë©”ì´ì…˜ì„ êµ¬í˜„í• ë•Œ `setTimeout()`ì´ë‚˜ `setInterval()`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆì—ˆëŠ”ë° ì´ëŸ° í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ì• ë‹ˆë©”ì´ì…˜ êµ¬í˜„ì˜ ë‹¨ì ì„ ê·¹ë³µí•œ ë°©ë²•ì´ `requestAnimationFrame()`ì´ë‹¤

<br>

## âœ… requestAnimationFrame()ë¥¼ ì™œ ì‚¬ìš©í•˜ëŠ”ê°€?
`setTimeout()`ì´ë‚˜ `setInterval()`ì€ ëšëš ëŠê¸°ëŠ” í”„ë ˆì„ ëˆ„ë½ í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤ í•˜ì§€ë§Œ `requestAnimationFrame()`ëŠ” ì´ˆë‹¹ 60í”„ë ˆì„ì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìëŠ” ì „í˜€ ë¶ˆí¸í•¨ì„ ëŠë¼ì§€ ì•ŠëŠ”ë‹¤ 

<br>

## âœ… requestAnimationFrame()ì™€ ì´ì „ ë°©ë²•ì˜ ì°¨ì´ì 
`setTimeout()`, `setInterval()`ê³¼ì˜ ì°¨ì´ì ì€ ë¸Œë¼ìš°ì €ê°€ ì‹¤í–‰ ì‹œê¸°ë¥¼ ê²°ì •í•œë‹¤ëŠ” ì ì´ë‹¤ ë˜í•œ setIntervalì€ ê³„ì† ë°˜ë³µì ì¸ ì½”ë“œë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆì§€ë§Œ `requestAnimationFrame()`ì€ ë°˜ë³µì ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— ì¬ê·€ì ì¸ í˜¸ì¶œì„ ì´ìš©í•´ì„œ êµ¬í˜„í•œë‹¤

<br>

# ğŸ‘‰ `requestAnimationFrame()`
ì¸ìë¡œëŠ” ë¦¬í˜ì¸íŒ… í•˜ê¸° ì „ì— ì‹¤í–‰ë  ì½œë°±í•¨ìˆ˜ë¥¼ ë°›ëŠ”ë‹¤ MDNì„ ì‚´í´ë³´ê²Œ ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…ë˜ì–´ ìˆë‹¤.

> window.requestAnimationFrame()ì€ ë¸Œë¼ìš°ì €ì—ê²Œ ìˆ˜í–‰í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ì•Œë¦¬ê³  ë‹¤ìŒ ë¦¬í˜ì¸íŠ¸ê°€ ì§„í–‰ë˜ê¸° ì „ì— í•´ë‹¹ ì• ë‹ˆë©”ì´ì…˜ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê²Œ í•©ë‹ˆë‹¤. ì´ ë©”ì†Œë“œëŠ” ë¦¬í˜ì¸íŠ¸ ì´ì „ì— ì‹¤í–‰í•  ì½œë°±ì„ ì¸ìë¡œ ë°›ìŠµë‹ˆë‹¤.  
(https://developer.mozilla.org/ko/docs/Web/API/Window/requestAnimationFrame)

ë°˜í™˜ê°’ìœ¼ë¡œëŠ” ìˆ«ìê°’ì„ ë°˜í™˜í•˜ëŠ”ë° ì•„ì´ë””ê°’ì´ë¼ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤ ë‚´ê°€ ë§Œë“  ì½”ë“œì—ì„œ í•´ë‹¹ ë¶€ë¶„ì„ í™•ì¸í•´ ë³´ì•˜ë‹¤.

```javascript
if (direction !== null) {
  rafId = requestAnimationFrame(move);
  console.log(rafId);
}
window.addEventListener("keyup", () => {
  cancelAnimationFrame(rafId)
})
```

![rafId](./img/rafId.png)

ìœ„ ìˆ«ì 1ë¶€í„° 10ê¹Œì§€ ëª¨ë‘ `requestAnimationFrame()`ì˜ ë°˜í™˜ê°’ì„ í• ë‹¹í•´ì„œ ì¶œë ¥í•œ ê°’ì´ë‹¤.

<br>

ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë‚´ê°€ ì›í•˜ëŠ”ëŒ€ë¡œ ì›€ì§ì´ëŠ” ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ë³´ê¸°ë¡œ í–ˆë‹¤. í‚¤ë³´ë“œì˜ í™”ì‚´í‘œ ë²„íŠ¼ì²˜ëŸ¼ ë§Œë“¤ì–´ì£¼ê³ , ë§ˆìš°ìŠ¤ë¡œ ëˆŒë €ì„ë•Œ í•´ë‹¹ ë°©í–¥ìœ¼ë¡œ ì´ë™í•˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤.
```javascript
const jongbin = document.querySelector(".jongbin");
const controller = document.querySelector(".controller");
const topBtn = controller.querySelector(".top");
const bottomBtn = controller.querySelector(".bottom");
const leftBtn = controller.querySelector(".left");
const rightBtn = controller.querySelector(".right");
let yPos = 0;
let xPos = 0;
let rafId;

const move = () => {
  if (direction === "â†‘") {
    yPos -= 3;
    jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
  } 
  if (direction === "â†“") {
    yPos += 3;
    jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
  } 
  if (direction === "â†") {
    xPos -= 3;
    jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
  } 
  if (direction === "â") {
    xPos += 3;
    jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
  } 
  rafId = requestAnimationFrame(move);
}

const handleUp = () => {
  cancelAnimationFrame(rafId);
}
const moveTop = () => {
  direction = "â†‘"
  move();
}
const moveBottom = () => {
  direction = "â†“"
  move();
}
const moveLeft = () => {
  direction = "â†"
  move();
}
const moveRight = () => {
  direction = "â"
  move();
}

topBtn.addEventListener("mousedown", moveTop);
bottomBtn.addEventListener("mousedown", moveBottom);
leftBtn.addEventListener("mousedown", moveLeft);
rightBtn.addEventListener("mousedown", moveRight);
controller.addEventListener("mouseup", handleUp);
```

![movejongbin](./img/movejongbin.gif)

ë§ˆìš°ìŠ¤ë¡œ ë²„íŠ¼ì„ ëˆ„ë¥¸ ìƒíƒœì— ì›€ì§ì´ë„ë¡ ë§Œë“¤ì–´ë‘ê³ , ë–¼ë©´ ë™ì‘ì„ ë©ˆì¶˜ë‹¤

ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ë°©í–¥ì„ ì„¤ì •í•˜ê³  moveí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì„œ í•´ë‹¹ ë°©í–¥ìœ¼ë¡œ ì´ë™í•˜ê²Œë” css(`transform: translate`)ë¥¼ ë³€ê²½í•´ì£¼ì—ˆë‹¤.

<u>ë©ˆì¶œë•ŒëŠ” `cancelAnimationFrame()`ë¥¼ ì´ìš©í•œë‹¤. ì´ í•¨ìˆ˜ëŠ” ì´ì „ì— ì‹¤í–‰í•œ `requestAnimationFrame()`ì˜ ë°˜í™˜ê°’ì„ ì „ë‹¬ë°›ì•„ í•´ë‹¹ ì• ë‹ˆë©”ì´ì…˜ì„ ë©ˆì¶”ê²Œ í•œë‹¤</u>

ë§Œì•½ ë©ˆì¶”ì§€ ì•Šìœ¼ë©´ ëë„ì—†ì´ ë™ì‘í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤

<br>

ì¶”ê°€ì ìœ¼ë¡œ ë§ˆìš°ìŠ¤ë¡œ ëˆŒë €ì„ë•Œ ë§ê³  í‚¤ë³´ë“œ í‚¤ë¥¼ ëˆŒë €ì„ë•Œ ë™ì‘í•˜ë„ë¡ ë§Œë“¤ì–´ ë³´ì•˜ë‹¤.
```javascript
const jongbin = document.querySelector(".jongbin");
const controller = document.querySelector(".controller");
const topBtn = controller.querySelector(".top");
const bottomBtn = controller.querySelector(".bottom");
const leftBtn = controller.querySelector(".left");
const rightBtn = controller.querySelector(".right");
let yPos = 0;
let xPos = 0;
let direction = null;
let rafId;
const move = () => {
    if (direction === "â†‘") {
        yPos -= 3;
        jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
    } 
    if (direction === "â†“") {
        yPos += 3;
        jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
    } 
    if (direction === "â†") {
        xPos -= 3;
        jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
    } 
    if (direction === "â") {
        xPos += 3;
        jongbin.style.transform = `translate(${xPos}px, ${yPos}px)`;
    } 
    // rafId = requestAnimationFrame(move);
    if (direction !== null) {
        rafId = requestAnimationFrame(move);
        console.log(rafId);
    }
    window.addEventListener("keyup", () => {
        cancelAnimationFrame(rafId)
    })
}

const handleUp = () => {
    direction = null;
    cancelAnimationFrame(rafId)
}
const moveTop = () => {
    direction = "â†‘"
    move()
}
const moveBottom = () => {
    direction = "â†“"
    move()
}
const moveLeft = () => {
    direction = "â†"
    move()
}
const moveRight = () => {
    direction = "â"
    move()
}

const keyMoveDown = (event) => {
    if (event.key === "ArrowUp") {
        direction = "â†‘";
        move();
    }
    if (event.key === "ArrowDown") {
        direction = "â†“";
        move();
    }
    if (event.key === "ArrowLeft") {
        direction = "â†";
        move();
    }
    if (event.key === "ArrowRight") {
        direction = "â";
        move();
    }

}
const keyMoveUp = () => {
    direction = null;
}

topBtn.addEventListener("mousedown", moveTop);
bottomBtn.addEventListener("mousedown", moveBottom);
leftBtn.addEventListener("mousedown", moveLeft);
rightBtn.addEventListener("mousedown", moveRight);
controller.addEventListener("mouseup", handleUp);

window.addEventListener("keydown", keyMoveDown)
window.addEventListener("keyup", keyMoveUp)

```

`addEventListener`ì˜ `keydown`ê³¼ `keyup`ì„ ì¶”ê°€í•´ì¤¬ë‹¤ ì´ì™¸ `keydown`ì„ ì ìš©í–ˆì„ë•Œ `cancelAnimationFrame()`ê°€ ì˜ ë¨¹íˆì§€ ì•ŠëŠ” ë¶€ë¶„ì´ ìˆì–´ì„œ `direction`ì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ í™•ì¸í•˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤ ì˜ ë¨¹íˆì§€ ì•ŠëŠ” ì´ìœ ë¥¼ ìƒê°í•´ë´¤ëŠ”ë° `keydown`ì„ ì‚¬ìš©í•˜ë©´ í‚¤ë¥¼ ëˆŒë €ì„ë•Œ í•œë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ì•„ë‹ˆê³  ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ì´ ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ ì¤‘ê°„ì— ì•„ì´ë””ê°’ì´ ëˆ„ë½ì´ ë˜ê±°ë‚˜ í•˜ëŠ”ê²ƒ ê°™ë‹¤ ì´í›„ í•œë²ˆë§Œ í˜¸ì¶œí•´ ì£¼ëŠ” ì´ë²¤íŠ¸ë¥¼ ì°¾ì•„ë´ì•¼ê² ë‹¤

